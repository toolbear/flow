on ApplicationIsRunning(appName)
    tell application "System Events" to set appNameIsRunning to exists (processes where name is appName)
    return appNameIsRunning
end ApplicationIsRunning

on run argv
    if not ApplicationIsRunning("Skype") then return

    if item 1 of argv is "diminish" then
        tell application "Skype"
            send command "SET USERSTATUS OFFLINE" script name "flow"
        end tell
    else if item 1 of argv is "restore" then
        tell application "Skype"
            send command "SET USERSTATUS ONLINE" script name "flow"
        end tell
    end if
    return
end run
